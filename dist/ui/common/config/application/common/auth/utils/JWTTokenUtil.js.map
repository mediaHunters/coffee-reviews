{"version":3,"sources":["../../../../../../../../src/ui/common/config/application/common/auth/utils/JWTTokenUtil.ts","../../../../../../../../src/ui/common/config/consts/variables.ts"],"sourcesContent":["import { IncomingHttpHeaders } from 'http';\n\nimport jwt, { Secret } from 'jsonwebtoken';\nimport { injectable } from 'inversify';\n\nimport { APP_TOKEN_SECRET } from 'ui/common/config/consts/variables';\nimport { User } from 'ui/common/models/User';\n\n@injectable()\nexport class JWTTokenUtil {\n  private readonly AUTH_HEADER = 'authorization';\n\n  private readonly SCHEME = 'bearer';\n\n  private readonly MATCHER = /(\\S+)\\s+(\\S+)/;\n\n  generateToken(\n    payload: User,\n    secret: Secret,\n    expiresIn: string | number,\n    payloadKey?: string\n  ): string {\n    return jwt.sign(payloadKey ? { [payloadKey]: payload } : payload, secret, {\n      expiresIn,\n    });\n  }\n\n  decodeToken<R extends object | string | null>(token: string): R {\n    try {\n      return jwt.verify(token, APP_TOKEN_SECRET) as R;\n    } catch {\n      return null as R;\n    }\n  }\n\n  getTokenFromHeaders(headers: IncomingHttpHeaders): any {\n    const authHeader = headers[this.AUTH_HEADER];\n    if (!authHeader) {\n      return null;\n    }\n    const matches = authHeader.match(this.MATCHER);\n    return matches && matches[2];\n  }\n}\n","import dotenv from 'dotenv';\n\ndotenv.config();\n\nexport const APP_TOKEN_SECRET = process.env.APP_TOKEN_SECRET || '';\nexport const APP_TOKEN_LIFE = process.env.APP_TOKEN_LIFE || '24h';\nexport const PORT = process.env.PORT || '3000';\nexport const LOG_LEVEL = process.env.LOG_LEVEL || 'debug';\nexport const SWAGGER_BASE_PATH = process.env.SWAGGER_BASE_PATH || '';\nexport const { SWAGGER_HOST } = process.env;\nexport const IS_DEVELOPMENT = process.env.NODE_ENV === 'development';\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,0BAA4B;AAC5B,uBAA2B;;;ACH3B,oBAAmB;AAEnB,cAAAA,QAAO,OAAO;AAEP,IAAM,mBAAmB,QAAQ,IAAI,oBAAoB;AACzD,IAAM,iBAAiB,QAAQ,IAAI,kBAAkB;AACrD,IAAM,OAAO,QAAQ,IAAI,QAAQ;AACjC,IAAM,YAAY,QAAQ,IAAI,aAAa;AAC3C,IAAM,oBAAoB,QAAQ,IAAI,qBAAqB;AAC3D,IAAM,EAAE,aAAa,IAAI,QAAQ;AACjC,IAAM,iBAAiB,QAAQ,IAAI,aAAa;;;ADDhD,IAAM,eAAN,MAAmB;AAAA,EAAnB;AACL,SAAiB,cAAc;AAE/B,SAAiB,SAAS;AAE1B,SAAiB,UAAU;AAAA;AAAA,EAE3B,cACE,SACA,QACA,WACA,YACQ;AACR,WAAO,oBAAAC,QAAI,KAAK,aAAa,EAAE,CAAC,UAAU,GAAG,QAAQ,IAAI,SAAS,QAAQ;AAAA,MACxE;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,YAA8C,OAAkB;AAC9D,QAAI;AACF,aAAO,oBAAAA,QAAI,OAAO,OAAO,gBAAgB;AAAA,IAC3C,QAAE;AACA,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEA,oBAAoB,SAAmC;AACrD,UAAM,aAAa,QAAQ,KAAK,WAAW;AAC3C,QAAI,CAAC,YAAY;AACf,aAAO;AAAA,IACT;AACA,UAAM,UAAU,WAAW,MAAM,KAAK,OAAO;AAC7C,WAAO,WAAW,QAAQ,CAAC;AAAA,EAC7B;AACF;AAlCa;AAAA,eAAN;AAAA,MADN,6BAAW;AAAA,GACC;","names":["dotenv","jwt"]}